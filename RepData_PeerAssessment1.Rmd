---
title: "RepData_PeerAssessment1"
author: "Maria"
date: "February 7, 2015"
output: html_document
---

```{r setup}
setwd("~/Dropbox/RTutorials/Coursera5-ReproducibleResearch/RepData_PeerAssessment1")
unzip("activity.zip")
data <- read.csv("activity.csv", header = TRUE,
                 stringsAsFactors = FALSE)
#create new variable for date as class date
data$date_type <- as.Date(data$date)
```

1. What is the mean total number of steps taken per day?
(Here we will ignore the missing values)

```{r part 1}
library(plyr)
library(ggplot2)
steps_day <- ddply(data, .(date_type), summarise,
                   totalSteps = sum(steps, na.rm = TRUE))

ggplot(steps_day, aes(x=totalSteps)) + 
    geom_histogram(binwidth=2000, colour="black", fill="white") +
    geom_vline(aes(xintercept=mean(totalSteps, na.rm=TRUE)),# Ignore NA values for mean
               color="red", linetype="dashed", size=1) +
    xlab("Total Steps Per Day") + ylab("Count") +
    ggtitle("Histogram of Total Steps Per Day")+
    theme_bw()

meanSteps <- mean(steps_day$totalSteps, na.rm = TRUE)
medianSteps <- median(steps_day$totalSteps, na.rm = TRUE)
```

The mean number of steps taken per day is `r round(meanSteps,0)`, excluding the missing values, while the median number of steps taken per day is `r medianSteps`.

2. What is the average daily activity pattern?

```{r part 2}
steps_int <- ddply(data, .(interval), summarise,
                   meanSteps = mean(steps, na.rm = TRUE))

ggplot(steps_int, aes(y=meanSteps, x=interval, group = 1)) + 
    geom_line() + geom_point() +
    xlab("Interval") + ylab("Mean Number of Steps") +
    ggtitle("Mean Number of Steps Per Interval")+
    theme_bw()

maxValue <- max(steps_int$meanSteps)
maxIndex <- which.max(steps_int$meanSteps)
maxInterval <- steps_int[maxIndex,1]
```

The `r maxInterval`th interval is the five-minute interval which contains, on average across all days in the data set, the maximum number of steps, with `r round(maxValue,0)` steps on average.